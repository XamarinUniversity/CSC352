<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
    <title>Using the lock ordering technique to remove potential deadlocks</title>
    <link rel="stylesheet" type="text/css" href="./res/styles/normalize.css">
    <link rel="stylesheet" type="text/css" href="./res/styles/prettify.css" />
    <link rel="stylesheet" type="text/css" href="./res/styles/styles.css">
</head>

<body>
    <!-- Use the same title as the StartHere -->
    <header>Thread Safety and Synchronization</header>

    <section id="main">

        <h1 id="page-title"></h1>

        <h2>Duration</h2>
        <p>5 minutes</p>

        <h2>Goals</h2>

        <p>
            In this final lab exercise, we will fix our deadlock issue by ensuring that we acquire the locks in a specific order.
        </p>

        <h2>Required assets</h2>
        <p>
            You will be continuing with the prior exercise's code in this lab.
            The provided <strong>Exercise 4</strong> folder contains a sub-folder named <strong>Completed</strong> with a solution you can use to check your work. 
        </p>

        <h2>Steps</h2>
        <p>
            To fix our broken program, we will need to acquire the locks (<code>firstSensor</code> and <code>secondSensor</code>) in a specific order.
        </p>
        <ol>
            <li>
                In the constructor for the <code>Cat</code> object, find the code that assigns <code>firstSensor</code> and <code>secondSensor</code>.
            </li>
            <li>
                Use the <code>Id</code> property of the sensor to compare them and assign our two local fields based on the property comparison.
            </li>
            <li>
                Run the application to see if it fixes the deadlock and improves the bites-per-second displayed next to each cat. (Hint: it should!)
            </li>
        </ol>

<p><a href="#" onclick="toggleCode(this,'lock');return false;" class="uiitem">Show Code</a>
<div class="indent-medium" id="lock" style="display:none;">
<pre class="prettyprint">
firstSensor = (left.Id > right.Id) ? left : right;
secondSensor = (left.Id > right.Id) ? right : left;
</pre>
</div>
</p>
        <h1>Summary</h1>
        <p>
            In this exercise you fixed the deadlock issue involved with acquiring two locks together. 
        </p>
        <div class="align-right">
            <a href="../Start%20Here.html">Go Back</a>
        </div>
    </section>

    <script src="./res/js/jquery.min.js"></script>
    <script src="./res/js/prettify.js"></script>
    <script src="./res/js/script.js"></script>

    <footer>Copyright (C) 2018 Xamarin Inc., Microsoft.</footer>
</body>
</html>
